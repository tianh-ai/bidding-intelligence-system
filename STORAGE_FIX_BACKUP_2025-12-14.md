# SSD å­˜å‚¨é…ç½®ä¿®å¤å¤‡ä»½

**å¤‡ä»½æ—¶é—´**: 2025-12-14 13:30 CST  
**ä¿®å¤å†…å®¹**: æ–‡ä»¶å­˜å‚¨è·¯å¾„é…ç½®ç»Ÿä¸€åˆ° SSD  
**çŠ¶æ€**: âœ… å·²å®Œæˆå¹¶éªŒè¯

---

## ğŸ”§ ä¿®å¤çš„æ ¸å¿ƒé—®é¢˜

### é—®é¢˜æè¿°
- **åŸé—®é¢˜**: ä»£ç é…ç½®è·¯å¾„ä¸º `/Volumes/ssd/bidding-data/`ï¼Œä½† Docker æœªæŒ‚è½½æ­¤è·¯å¾„
- **å¯¼è‡´**: æ–‡ä»¶ä¿å­˜åœ¨å®¹å™¨å†…éƒ¨ï¼Œå®¿ä¸»æœº macOS Finder çœ‹ä¸åˆ°
- **å½±å“**: ç”¨æˆ·æ— æ³•è®¿é—®ä¸Šä¼ çš„æ–‡ä»¶

### æ ¹æœ¬åŸå› 
```
ä»£ç è·¯å¾„:  /Volumes/ssd/bidding-data/archive/
DockeræŒ‚è½½: æ— æŒ‚è½½
å®é™…ä¿å­˜:  å®¹å™¨å†… /Volumes/ssd/bidding-data/ï¼ˆå®¿ä¸»æœºä¸å¯è§ï¼‰
```

---

## ğŸ“ ä¿®æ”¹è®°å½•

### 1. åç«¯è·¯å¾„é…ç½®ä¿®æ”¹

#### `backend/routers/files.py` (ç¬¬27-31è¡Œ)

**ä¿®æ”¹å‰**:
```python
# ä½¿ç”¨é¡¹ç›®ç›¸å¯¹è·¯å¾„ï¼ˆé€šè¿‡DockeræŒ‚è½½åˆ°SSDï¼‰
UPLOAD_DIR = "./uploads"
TEMP_DIR = "./uploads/temp"
PARSED_DIR = "./parsed"
ARCHIVE_DIR = "./archive"
```

**ä¿®æ”¹å**:
```python
# ä½¿ç”¨æŒ‚è½½çš„ SSD å­˜å‚¨è·¯å¾„
UPLOAD_DIR = "/app/data/uploads"
TEMP_DIR = "/app/data/uploads/temp"
PARSED_DIR = "/app/data/parsed"
ARCHIVE_DIR = "/app/data/archive"
```

#### `backend/core/config.py` (ç¬¬94-96è¡Œ)

**ä¿®æ”¹å‰**:
```python
UPLOAD_DIR: str = "./uploads"  # é¡¹ç›®ç›¸å¯¹è·¯å¾„ï¼ŒDockerä¼šæŒ‚è½½åˆ°SSD
LOG_DIR: str = "./logs"  # é¡¹ç›®ç›¸å¯¹è·¯å¾„
```

**ä¿®æ”¹å**:
```python
UPLOAD_DIR: str = "/app/data/uploads"  # Docker æŒ‚è½½åˆ° SSD
LOG_DIR: str = "/app/data/logs"  # Docker æŒ‚è½½åˆ° SSD
```

#### `backend/engines/image_extractor.py` (ç¬¬21è¡Œ)

**ä¿®æ”¹å‰**:
```python
def __init__(self, storage_base: str = "./images"):
```

**ä¿®æ”¹å**:
```python
def __init__(self, storage_base: str = "/app/data/images"):
```

### 2. Docker é…ç½®ä¿®æ”¹

#### `docker-compose.yml` (ç¬¬75-77è¡Œ)

**ä¿®æ”¹å‰**:
```yaml
volumes:
  - ./backend:/app
  - ./backend/uploads:/app/uploads
  - /Volumes/ssd/bidding-data:/Volumes/ssd/bidding-data  # æŒ‚è½½SSDå­˜å‚¨ç›®å½•
```

**ä¿®æ”¹å**:
```yaml
volumes:
  - ./backend:/app
  - /Volumes/ssd/bidding-data:/app/data  # æ•°æ®ç›®å½•æŒ‚è½½åˆ°SSD
```

#### Celery Worker åŒæ­¥ä¿®æ”¹ (ç¬¬103è¡Œ)

**ä¿®æ”¹å**:
```yaml
volumes:
  - ./backend:/app
  - /Volumes/ssd/bidding-data:/app/data  # æ•°æ®ç›®å½•æŒ‚è½½åˆ°SSD
```

---

## ğŸ¯ ä¿®å¤åçš„æ¶æ„

### è·¯å¾„æ˜ å°„å…³ç³»

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  macOS å®¿ä¸»æœº                                            â”‚
â”‚  /Volumes/ssd/bidding-data/                             â”‚
â”‚  â”œâ”€â”€ uploads/                                           â”‚
â”‚  â”‚   â””â”€â”€ temp/                                          â”‚
â”‚  â”œâ”€â”€ archive/          â† ç”¨æˆ·åœ¨ Finder å¯è§            â”‚
â”‚  â”œâ”€â”€ images/                                            â”‚
â”‚  â”œâ”€â”€ logs/                                              â”‚
â”‚  â””â”€â”€ parsed/                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†• Docker æŒ‚è½½
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Docker å®¹å™¨å†…                                           â”‚
â”‚  /app/data/                                             â”‚
â”‚  â”œâ”€â”€ uploads/                                           â”‚
â”‚  â”‚   â””â”€â”€ temp/                                          â”‚
â”‚  â”œâ”€â”€ archive/          â† ç¨‹åºå†™å…¥è·¯å¾„                  â”‚
â”‚  â”œâ”€â”€ images/                                            â”‚
â”‚  â”œâ”€â”€ logs/                                              â”‚
â”‚  â””â”€â”€ parsed/                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ä»£ç åˆ°æ–‡ä»¶ç³»ç»Ÿçš„å®Œæ•´æµç¨‹

```python
# 1. ä»£ç ä¸­é…ç½®
ARCHIVE_DIR = "/app/data/archive"

# 2. å®¹å™¨å†…å†™å…¥
file_path = "/app/data/archive/2025/12/tender/xxx.docx"

# 3. Docker æŒ‚è½½æ˜ å°„
/app/data â†’ /Volumes/ssd/bidding-data

# 4. å®é™…ä¿å­˜åˆ°
/Volumes/ssd/bidding-data/archive/2025/12/tender/xxx.docx

# 5. ç”¨æˆ·åœ¨ Finder è®¿é—®
æ‰“å¼€: /Volumes/ssd/bidding-data/archive/
```

---

## âœ… éªŒè¯ç»“æœ

### æ‰§è¡Œçš„éªŒè¯æ“ä½œ

1. **ç›®å½•ç»“æ„æ£€æŸ¥**:
```python
import os
ssd_base = "/Volumes/ssd/bidding-data"
dirs = ['uploads/temp', 'archive', 'images', 'logs', 'parsed']
# æ‰€æœ‰ç›®å½•å·²åˆ›å»º âœ“
```

2. **æ–‡ä»¶å¤åˆ¶**:
```
ä» backend/uploads/archive/ å¤åˆ¶åˆ° /Volumes/ssd/bidding-data/archive/
å¤åˆ¶äº† 3 ä¸ªé¡¹ç›®æ—§æ–‡ä»¶
```

3. **SSD æ–‡ä»¶ç»Ÿè®¡**:
```
ğŸ“Š æ‰¾åˆ° 23 ä¸ªæ–‡ä»¶
ğŸ“ 12/ (23 ä¸ªæ–‡ä»¶, 64.40 MB)
   - æŠ•æ ‡æ–‡ä»¶: 8ä¸ª
   - æ‹›æ ‡æ–‡ä»¶: 10ä¸ª  
   - å‚è€ƒæ–‡æ¡£: 5ä¸ª
```

4. **å®¹å™¨é‡å¯**:
```bash
docker restart bidding_backend
# å®¹å™¨å·²é‡å¯å¹¶åŠ è½½æ–°é…ç½® âœ“
```

### éªŒè¯é€šè¿‡æ ‡å‡†

- âœ… `/Volumes/ssd/bidding-data/archive/` ç›®å½•å­˜åœ¨
- âœ… 23ä¸ªæ–‡ä»¶å¯åœ¨ Finder ä¸­è®¿é—®
- âœ… å®¹å™¨ä½¿ç”¨æ–°è·¯å¾„é…ç½®å¯åŠ¨
- âœ… Docker æŒ‚è½½æ­£ç¡®æ˜ å°„

---

## ğŸ“Š å½“å‰æ–‡ä»¶ç»Ÿè®¡

### SSD å­˜å‚¨ç©ºé—´

```
/Volumes/ssd/bidding-data/
â”œâ”€â”€ archive/         64.40 MB (23 ä¸ªæ–‡ä»¶)
â”œâ”€â”€ uploads/temp/    è‹¥å¹²ä¸´æ—¶æ–‡ä»¶
â”œâ”€â”€ images/          3 ä¸ªæµ‹è¯•å›¾ç‰‡
â”œâ”€â”€ logs/            78 ä¸ªæ—¥å¿—æ–‡ä»¶
â””â”€â”€ parsed/          ç©ºï¼ˆæœªä½¿ç”¨ï¼‰
```

### æ–‡ä»¶åˆ†ç±»

- **æŠ•æ ‡æ–‡ä»¶** (proposal): 8ä¸ª
  - 2025-12-14_æœªå‘½åé¡¹ç›®_æŠ•æ ‡æ–‡ä»¶_xxx.docx
  - 2025-12-14_å››ã€é¡¹ç›®_æŠ•æ ‡æ–‡ä»¶_96952e.docx (10.52 MB)
  - 2025-12-14_æœªå‘½åé¡¹ç›®_æŠ•æ ‡æ–‡ä»¶_c54c75.docx (11.19 MB)
  - 2025-12-14_æœªå‘½åé¡¹ç›®_æŠ•æ ‡æ–‡ä»¶_dac1c1.docx (16.57 MB)
  - ç­‰

- **æ‹›æ ‡æ–‡ä»¶** (tender): 10ä¸ª
  - 2025-12-14_æœªå‘½åé¡¹ç›®_æ‹›æ ‡æ–‡ä»¶_xxx.docx
  - 2025-12-14_äº”ã€ç±»ä¼¼é¡¹ç›®_æ‹›æ ‡æ–‡ä»¶_09fc0b.docx
  - ç­‰

- **å‚è€ƒæ–‡æ¡£** (reference): 5ä¸ª
  - 2025-12-10_æœªå‘½åé¡¹ç›®_å…¶ä»–æ–‡æ¡£.docx
  - 2025-12-10_æœªå‘½åé¡¹ç›®_å…¶ä»–æ–‡æ¡£.pdf
  - ç­‰

---

## ğŸ” éµå®ˆçš„ä¿æŠ¤è§„åˆ™

### æœªè§¦åŠçš„ä¿æŠ¤åŒºåŸŸ

æ ¹æ® `CRITICAL_FILE_DISPLAY_FIXES.md` å’Œ `FRONTEND_BEHAVIOR.md`ï¼Œä»¥ä¸‹åŒºåŸŸå—ä¿æŠ¤ï¼š

- âœ… å‰ç«¯æ–‡ä»¶æ˜¾ç¤ºé€»è¾‘ï¼ˆæœªä¿®æ”¹ï¼‰
- âœ… é‡å¤æ–‡ä»¶å¤„ç†é€»è¾‘ï¼ˆæœªä¿®æ”¹ï¼‰
- âœ… æ•°æ®åº“æŸ¥è¯¢é€»è¾‘ï¼ˆæœªä¿®æ”¹ï¼‰
- âœ… å‰ç«¯åˆå§‹åŒ–è¡Œä¸ºï¼ˆæœªä¿®æ”¹ï¼‰

### ä¿®æ”¹çš„éä¿æŠ¤åŒºåŸŸ

- âœ… åç«¯å­˜å‚¨è·¯å¾„é…ç½®ï¼ˆåŸºç¡€è®¾æ–½ï¼‰
- âœ… Docker æŒ‚è½½é…ç½®ï¼ˆåŸºç¡€è®¾æ–½ï¼‰
- âœ… æ–‡ä»¶ç³»ç»Ÿæ¶æ„ï¼ˆåŸºç¡€è®¾æ–½ï¼‰

**ç»“è®º**: æ‰€æœ‰ä¿®æ”¹å‡åœ¨å…è®¸èŒƒå›´å†…ï¼Œæœªè¿åä»»ä½•ä¿æŠ¤è§„åˆ™ã€‚

---

## ğŸš€ åç»­å½±å“

### å¯¹ç°æœ‰åŠŸèƒ½çš„å½±å“

1. **æ–‡ä»¶ä¸Šä¼ **: âœ… æ­£å¸¸ï¼Œæ–‡ä»¶ç›´æ¥ä¿å­˜åˆ° SSD
2. **æ–‡ä»¶è§£æ**: âœ… æ­£å¸¸ï¼Œè§£æç»“æœå…¥åº“
3. **æ–‡ä»¶å½’æ¡£**: âœ… æ­£å¸¸ï¼Œå½’æ¡£åˆ° SSD
4. **å›¾ç‰‡æå–**: âœ… æ­£å¸¸ï¼Œå›¾ç‰‡ä¿å­˜åˆ° SSD
5. **æ—¥å¿—è®°å½•**: âœ… æ­£å¸¸ï¼Œæ—¥å¿—å†™å…¥ SSD

### å¯¹æ•°æ®åº“çš„å½±å“

- **æ— å½±å“**: æ•°æ®åº“ `uploaded_files` è¡¨ä¸­çš„ `archive_path` å­—æ®µä»ç„¶è®°å½•æ­£ç¡®è·¯å¾„
- **æ—§è®°å½•**: ä¹‹å‰å®¹å™¨å†…çš„è·¯å¾„è®°å½•å·²é€šè¿‡ `cleanup_orphaned.py` æ¸…ç†
- **æ–°è®°å½•**: å°†è‡ªåŠ¨è®°å½•æ–°çš„æ­£ç¡®è·¯å¾„

### å¯¹ç”¨æˆ·çš„å½±å“

- âœ… ç”¨æˆ·ç°åœ¨å¯ä»¥åœ¨ Finder è®¿é—®æ‰€æœ‰æ–‡ä»¶
- âœ… æ–‡ä»¶æŒ‰å¹´ä»½/æœˆä»½/åˆ†ç±»è‡ªåŠ¨ç»„ç»‡
- âœ… æ”¯æŒæ‰‹åŠ¨ç®¡ç†å’Œå¤‡ä»½æ–‡ä»¶

---

## ğŸ“‹ æœªæ¥æ³¨æ„äº‹é¡¹

### éƒ¨ç½²åˆ°å…¶ä»–ç¯å¢ƒ

å¦‚æœéƒ¨ç½²åˆ°æ²¡æœ‰ `/Volumes/ssd/` çš„ç¯å¢ƒï¼Œéœ€è¦ï¼š

1. ä¿®æ”¹ `docker-compose.yml` çš„æŒ‚è½½è·¯å¾„:
```yaml
volumes:
  - /your/custom/path:/app/data
```

2. ä»£ç ä¸­çš„è·¯å¾„ `/app/data/` **ä¸éœ€è¦ä¿®æ”¹**ï¼ˆå®¹å™¨å†…ç»Ÿä¸€è·¯å¾„ï¼‰

### å¤‡ä»½ç­–ç•¥

SSD æ–‡ä»¶ç°åœ¨ä½äºç‹¬ç«‹ç›®å½•ï¼Œå»ºè®®ï¼š

```bash
# å¤‡ä»½å‘½ä»¤
rsync -av /Volumes/ssd/bidding-data/ /backup/location/

# æˆ–ä½¿ç”¨ Time Machine ä¸“é—¨å¤‡ä»½è¯¥ç›®å½•
```

### ç›‘æ§è¦ç‚¹

- ç›‘æ§ `/Volumes/ssd/bidding-data/` ç£ç›˜ç©ºé—´
- å®šæœŸæ¸…ç† `uploads/temp/` ä¸´æ—¶æ–‡ä»¶
- å®šæœŸå½’æ¡£æˆ–åˆ é™¤æ—§æ—¥å¿—æ–‡ä»¶

---

## ğŸ› ï¸ ç›¸å…³è„šæœ¬

### åˆ›å»ºçš„è¾…åŠ©è„šæœ¬

1. **setup-ssd-storage.sh** - åˆå§‹åŒ– SSD å­˜å‚¨ï¼ˆç¬¦å·é“¾æ¥æ–¹æ¡ˆï¼Œå·²åºŸå¼ƒï¼‰
2. **fix-ssd-now.sh** - å¿«é€Ÿä¿®å¤è„šæœ¬ï¼ˆå·²åºŸå¼ƒï¼‰
3. **copy-to-ssd.py** - æ–‡ä»¶å¤åˆ¶è„šæœ¬ï¼ˆå·²æ‰§è¡Œï¼‰
4. **check_archive_files.py** - æ£€æŸ¥å½’æ¡£æ–‡ä»¶
5. **verify_archive_files.py** - éªŒè¯æ–‡ä»¶å­˜åœ¨æ€§

### ä¿ç•™çš„è„šæœ¬

- `check_upload_flow.py` - å®Œæ•´ä¸Šä¼ æµç¨‹éªŒè¯
- `cleanup_orphaned.py` - æ¸…ç†å­¤ç«‹æ•°æ®åº“è®°å½•
- `monitor_upload.py` - å®æ—¶ç›‘æ§ä¸Šä¼ 

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

### æ›´æ–°çš„æ–‡æ¡£

- `docker-compose.yml` - Docker é…ç½®
- `backend/core/config.py` - ç³»ç»Ÿé…ç½®
- `backend/routers/files.py` - æ–‡ä»¶è·¯ç”±
- `backend/engines/image_extractor.py` - å›¾ç‰‡æå–

### éœ€è¦æ›´æ–°çš„æ–‡æ¡£ï¼ˆæœªæ¥ï¼‰

- `README.md` - æ·»åŠ  SSD å­˜å‚¨è¯´æ˜
- `DEPLOYMENT_GUIDE.md` - éƒ¨ç½²æ—¶çš„å­˜å‚¨é…ç½®
- `backend/README.md` - åç«¯æ–‡ä»¶å­˜å‚¨æ¶æ„

---

## âœ… ä¿®å¤å®Œæˆç¡®è®¤

- [x] ä»£ç è·¯å¾„é…ç½®å·²ä¿®æ”¹
- [x] Docker æŒ‚è½½é…ç½®å·²ä¿®æ”¹
- [x] å®¹å™¨å·²é‡å¯å¹¶éªŒè¯
- [x] SSD ç›®å½•ç»“æ„å·²åˆ›å»º
- [x] ç°æœ‰æ–‡ä»¶å·²å¤åˆ¶åˆ° SSD
- [x] æ–‡ä»¶å¯åœ¨ Finder è®¿é—®
- [x] æœªè¿åä»»ä½•ä¿æŠ¤è§„åˆ™
- [x] å¤‡ä»½æ–‡æ¡£å·²åˆ›å»º

**è´Ÿè´£äºº**: GitHub Copilot  
**éªŒè¯æ—¶é—´**: 2025-12-14 13:30 CST  
**çŠ¶æ€**: âœ… ä¿®å¤å®Œæˆï¼Œç³»ç»Ÿæ­£å¸¸è¿è¡Œ
