# ========================================
# 标书智能系统 - 局域网部署配置
# ========================================
# 部署日期: 2025-12-08
# 部署模式: 本机作为局域网服务器
# 数据存储: 全部本地化存储

# ========== 网络配置 ==========
# 服务器监听地址（0.0.0.0表示接受所有网络接口的连接）
HOST=0.0.0.0

# 后端API端口（局域网访问地址: http://本机IP:18888）
PORT=18888

# 前端端口（局域网访问地址: http://本机IP:13000）
FRONTEND_PORT=13000

# CORS 允许的来源（允许局域网所有设备访问）
# 格式: http://192.168.x.x:5173,http://10.0.x.x:5173
# 使用 * 允许所有来源（开发环境可用，生产环境建议具体指定）
CORS_ORIGINS=*

# ========== 数据库配置 ==========
# PostgreSQL 数据库设置
DB_HOST=postgres  # Docker内部网络使用容器名，本地部署改为localhost
DB_PORT=5432      # 容器内部端口
DB_EXTERNAL_PORT=15432  # 主机映射端口（避免与本地PostgreSQL冲突）
DB_USER=postgres
DB_PASSWORD=BiddingSystem@2025  # 请修改为强密码
DB_NAME=bidding_db
DB_POOL_SIZE=10   # 支持更多并发连接
DB_MAX_OVERFLOW=20

# ========== Redis配置 ==========
REDIS_HOST=redis  # Docker内部网络使用容器名，本地部署改为localhost
REDIS_PORT=6379   # 容器内部端口
REDIS_EXTERNAL_PORT=16379  # 主机映射端口（避免与本地Redis冲突）
REDIS_DB=0
REDIS_PASSWORD=   # 生产环境建议设置密码

# ========== Celery配置 ==========
CELERY_BROKER_URL=redis://redis:6379/1
CELERY_RESULT_BACKEND=redis://redis:6379/2

# ========== 文件存储配置（本地化存储） ==========
# 上传文件存储路径（将映射到主机目录）
UPLOAD_DIR=/app/uploads

# 主机数据持久化目录（SSD盘存储）
# 数据库数据目录
HOST_DATA_POSTGRES=/Volumes/ssd/files/bidding-system/data/postgres

# Redis数据目录
HOST_DATA_REDIS=/Volumes/ssd/files/bidding-system/data/redis

# 上传文件目录
HOST_DATA_UPLOADS=/Volumes/ssd/files/bidding-system/uploads

# 日志目录
HOST_DATA_LOGS=/Volumes/ssd/files/bidding-system/logs

# 最大文件大小（100MB，支持大型标书文件）
MAX_FILE_SIZE=104857600

# 允许的文件类型
ALLOWED_EXTENSIONS=.pdf,.docx,.doc,.xlsx,.xls,.txt

# ========== AI模型配置 ==========
# OpenAI（可选，用于高级功能）
OPENAI_API_KEY=sk-your-openai-key-here
OPENAI_MODEL=gpt-4-turbo
OPENAI_EMBEDDING_MODEL=text-embedding-3-small
OPENAI_MAX_TOKENS=4000
OPENAI_TEMPERATURE=0.3

# DeepSeek（主要使用，成本低）
DEEPSEEK_API_KEY=sk-1fc432ea945d4c448f3699d674808167
DEEPSEEK_BASE_URL=https://api.deepseek.com
DEEPSEEK_MODEL=deepseek-chat

# Qwen（备用）
QWEN_API_KEY=sk-17745e25a6b74f4994de3b8b42341b57
QWEN_BASE_URL=https://dashscope.aliyuncs.com/compatible-mode/v1
QWEN_MODEL=qwen-plus

# ========== 应用配置 ==========
PROJECT_NAME="标书智能系统"
VERSION="1.0.0"
DEBUG=false  # 生产环境设为false
LOG_LEVEL=INFO
LOG_FORMAT=json

# ========== 缓存配置 ==========
CACHE_ENABLED=true
CACHE_DEFAULT_TTL=3600
CACHE_PARSED_FILE_TTL=7200
CACHE_CHAPTER_LOGIC_TTL=86400
CACHE_GLOBAL_LOGIC_TTL=86400

# ========== 安全配置 ==========
# 请务必修改为随机字符串（用于JWT签名）
SECRET_KEY=change-this-to-a-random-secret-key-BiddingSystem2025
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=60  # 局域网环境可延长至1小时
JWT_REFRESH_TOKEN_EXPIRE_DAYS=7

# ========== 性能配置 ==========
MAX_CONCURRENT_TASKS=20  # 根据服务器性能调整
PARSING_TIMEOUT=600      # 10分钟
GENERATION_TIMEOUT=1200  # 20分钟

# ========== OCR配置 ==========
OCR_ENABLED=true
OCR_LANGUAGE=ch  # 中文+英文
OCR_USE_GPU=false  # 如果有GPU可设为true

# ========================================
# 部署检查清单:
# 1. 修改 DB_PASSWORD 为强密码
# 2. 修改 SECRET_KEY 为随机字符串
# 3. 确认 HOST_DATA_* 目录路径存在且有写权限
# 4. 检查防火墙是否开放 5173 和 8000 端口
# 5. 获取本机局域网IP: ifconfig | grep "inet "
# ========================================
